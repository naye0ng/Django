# Django - Instagram

*2019.04.08 - 2019.04.10*

## 1. Django í™˜ê²½ì„¤ì •

### 1-1. pyenv  ì„¤ì¹˜

```shell
git clone https://github.com/pyenv/pyenv.git ~/.pyenv
echo 'export PYENV_ROOT="$HOME/.pyenv"' >> ~/.bashrc
echo 'export PATH="$PYENV_ROOT/bin:$PATH"' >> ~/.bashrc
echo -e 'if command -v pyenv 1>/dev/null 2>&1; then\n  eval "$(pyenv init -)"\nfi' >> ~/.bashrc
exec "$SHELL"

git clone https://github.com/pyenv/pyenv-virtualenv.git $(pyenv root)/plugins/pyenv-virtualenv
echo 'eval "$(pyenv virtualenv-init -)"' >> ~/.bashrc
exec "$SHELL"
```



### 1-2. pyenvë¡œ python 3.6.7 ì„¤ì¹˜

```shell
$pyenv install 3.6.7

# python ë²„ì „ì„ í™•ì¸í•´ë³´ë©´ 3.6.7ì´ ì•„ë‹Œ 2.7.6ì„ ì¶œë ¥í•œë‹¤.
$python --version
Python 2.7.6

# python ë²„ì „ì„ ì„¤ì •í•´ì¤€ë‹¤.
$pyenv global 3.6.7
$python --version
Python 3.6.7
```



### 1-3. pyenvë¡œ ê°€ìƒí™˜ê²½ ì„¤ì •

```shell
$mkdir INSTAGRAM
$cd INSTAGRAM/
$pyenv virtualenv 3.6.7 insta-env
$pyenv local insta-env

# ë²„ì „ê´€ë¦¬ ì‹œì‘
# ì¥ê³ ë²„ì „ì´ 2019.04.01ì´í›„ë¡œ 2.2ë¡œ ë¦´ë¦¬ì¦ˆë˜ì—ˆìœ¼ë¯€ë¡œ ë²„ì „ì„ ëª…ì‹œí•´ì¤˜ì•¼ 2.1ë²„ì „ì´ ì„¤ì¹˜ ê°€ëŠ¥í•˜ë‹¤.
(insta-env)$pip install django==2.1.7 
```



### 1-4. Django í”„ë¡œì íŠ¸ ìƒì„±

```shell
(insta-env)$django-admin startproject instagram .
```



## 2. Django ì•± ìƒì„±

### 2-1. postsì•± ìƒì„±

```shell
(insta-env)$python manage.py startapp posts
```



### 2-2. ê³µìš© í…œí”Œë¦¿ ë§Œë“¤ê¸°

```shell
.
â”œâ”€â”€ README.md
â”œâ”€â”€ db.sqlite3
â”œâ”€â”€ instagram
â”‚Â Â  â”œâ”€â”€ __init__.py
â”‚Â Â  â”œâ”€â”€ __pycache__
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __init__.cpython-36.pyc
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ settings.cpython-36.pyc
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ urls.cpython-36.pyc
â”‚Â Â  â”‚Â Â  â””â”€â”€ wsgi.cpython-36.pyc
â”‚Â Â  â”œâ”€â”€ settings.py
â”‚Â Â  â”œâ”€â”€ urls.py
â”‚Â Â  â””â”€â”€ wsgi.py
â”œâ”€â”€ manage.py
â”œâ”€â”€ posts
â””â”€â”€ templates
    â””â”€â”€ base.html
# template
```

ìœ„ì™€ ê°™ì´, ì•± ì „ì²´ì— ì ìš©ë˜ëŠ” templatesí´ë”ë¥¼ ë§Œë“¤ì—ˆë‹¤ë©´, í•´ë‹¹ í…œí”Œë¦¿ì˜ ì£¼ì†Œë¥¼ settings.pyì— ëª…ì‹œí•´ì¤˜ì•¼ í•œë‹¤.

osë³„ë¡œ templatesê²½ë¡œê°€ ë‹¬ë¼ì§€ë¯€ë¡œ ê²½ë¡œë¥¼ Djangoê°€ ì•Œì•„ì„œ ì¡ë„ë¡ ì„¤ì •í•œë‹¤.

```python
'''
settings.py
'''
TEMPLATES = [
    {...
        'DIRS': [os.path.join(BASE_DIR,'templates')],
    },...
]
```



### 2-5. Postëª¨ë¸ ì •ì˜

```python
# posts/models.py
class Post(models.Model):
    content =models.CharField(max_length=150)
```



### 2-4. postsì•± url ì„¤ì •

```python
# urls.py
urlpatterns = [
    ...,
    path('posts/', include('posts.urls')),
]
```



### 2-5. Postì˜ ModelFormì •ì˜ğŸ¤Ÿ

```python
# posts/forms.py
from django import forms
from .models import Post

# Postë¼ëŠ” ëª¨ë¸ì„ ì¡°ì‘í•  ìˆ˜ ìˆëŠ” PostModelFormì„ ì •ì˜
class PostModelForm(forms.ModelForm):
    # 1. ì–´ë–¤ input í•„ë“œë¥¼ ê°€ì§€ëŠ”ì§€
    content = forms.CharField(label='content',widget=forms.Textarea(attrs={
        'placeholder' : 'ì˜¤ëŠ˜ì€ ë¬´ì—‡ì„ í•˜ì…¨ë‚˜ìš”?'
    }))
    
    # 2. í•´ë‹¹ input
    class Meta :
        model = Post
        fields = ['content']
```



### 2-6. ModelFormì—ì„œì˜ Bootstrap ì ìš©ğŸ¤Ÿ

```shell
# Django-bootstrap4 íŒ¨í‚¤ì§€ ì„¤ì¹˜
$pip install Django-bootstrap4
```

```python
# settings.pyì— ì¶”ê°€
INSTALLED_APPS = [
    ...,
    'bootstrap4',
]
```

```html
<!-- posts/create.html -->
{% extends 'base.html' %}
<!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© í¼ ë¡œë“œ -->
{% load bootstrap4 %}

{% block body %}
<form method='POST'>
  <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© form ì‚¬ìš©í•˜ê¸° -->
  {% bootstrap_form form %}
</form>
{% endblock %}
```



## Django - View decorators

Djangoë¡œ ë§Œë“  ì›¹ ì„œë¹„ìŠ¤ì— í—ˆìš©ëœ httpìš”ì²­(get, post) ë§Œì„ ë°›ë„ë¡ ì œí•œí•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.

*https://docs.djangoproject.com/en/2.2/topics/http/decorators/*