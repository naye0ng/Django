# Django - vue.js ì—°ë™í•˜ê¸°

*2019.05.14*



## follow ê¸°ëŠ¥ êµ¬í˜„í•˜ê¸°

### 1. vue : delimiters ì„¤ì •í•˜ê¸°

django template language ì™€ vue.jsì˜ mustacheê°€ `{{ }}`ë¡œ ë™ì¼í•˜ë¯€ë¡œ vue.jsì˜ mustacheë¥¼ ë³€ê²½í•´ì¤€ë‹¤.

```javascript
const app = new Vue({
    delimiters : ['[[',']]'],
    data : {
        vlaue : 'test',
    }
})
```

```html
<div id="app">
    <p>[[value]]</p>
</div>
```



### 2. vue ì™€ django ì—°ë™ğŸ¤Ÿ

vueëŠ” html ì „ì²´ê°€ ë Œë”ë§ ëœ í›„ì— ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ, django ë³€ìˆ˜ë¥¼ vue ì— ì „ë‹¬í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.

**ì¦‰, DTL(django template language) ì€ html ë¿ë§Œ ì•„ë‹ˆë¼ javascript ë‚´ë¶€ì—ì„œë„ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.**

```html
<div id="app">
    <p>follow : [[ followed ]]</p>
    <!-- 
		1. class toggle
		2. call follow() 
		3. v-show : ë¡œë”© ê°’ì´ Trueì´ë©´(ê°’ì„ ë°›ì•„ì˜¨ ê²½ìš°) ë³´ì—¬ì¤€ë‹¤.
	-->
    <button v-show="loading" :class="{'btn':true, 'btn-primary':folloewd, 'btn-dark':!followed}" @click="follow({{people.id}})">VueíŒ”ë¡œìš°</button>
      </div>
```

```javascript
<script>
  const app = new Vue({
    delimiters : ['[[',']]'],
    el : '#app',
    data : {
      value : 30,
      followed : '',
      loading : false,
    }, 
    methods :{
      follow : function() {
        axios.get('/accounts/${person_id}/vueFollow/')
          .then(res => res.data)
          .then(data => {
            this.followed = data.followed
          })
      },
      checkFollow : function(person_id){
        axios.get('/accounts/${person_id}/checkFollow/')
          .then(res => res.data)
          .then(data => {
            this.followed = data.followed
            this.loading = True
          })
      },
    },
    beforeMount : function(){
      // ì´ë¶€ë¶„!! script ë‚´ë¶€ì—ì„œ ë™ì‘í•˜ëŠ” DTL
      this.checkFollow({{ people.id }})
    }
  })
</script>
```


```python
from django.http import JsonResponse

# íŒ”ë¡œìš°ë¥¼ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜
def vue_follow(request, user_id):
    person = get_object_or_404(get_user_model(), pk=user_id)
    
    if request.user in person.followers.all():
        person.followers.remove(user=request.user) 
        followed = False
    else :
        person.followers.add(request.user)
        followed = True
    return JsonResponse({'followed':followed})

# í˜ì´ì§€ê°€ ì²˜ìŒ ëœë”ë˜ì—ˆì„ ë•Œ íŒ”ë¡œìš° ì—¬ë¶€ë¥¼ ì•Œë ¤ì£¼ê¸° ìœ„í•œ í•¨ìˆ˜
def check_follow(request, user_id):
    person = get_object_or_404(get_user_model(), pk=user_id)
    
    if request.user in person.followers.all():
        followed = True
    else :
        followed = False
    return JsonResponse({'followed':followed})
```

